<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Home · SMLMFrameConnection.jl</title><script data-outdated-warner src="assets/warner.js"></script><link rel="canonical" href="https://JuliaSMLM.github.io/SMLMFrameConnection.jl/"/><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.039/juliamono-regular.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.13.11/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="assets/documenter.js"></script><script src="siteinfo.js"></script><script src="../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href>SMLMFrameConnection.jl</a></span></div><form class="docs-search" action="search/"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li class="is-active"><a class="tocitem" href>Home</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>Home</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Home</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/JuliaSMLM/SMLMFrameConnection.jl/blob/master/docs/src/index.md#" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h1 id="SMLMFrameConnection"><a class="docs-heading-anchor" href="#SMLMFrameConnection">SMLMFrameConnection</a><a id="SMLMFrameConnection-1"></a><a class="docs-heading-anchor-permalink" href="#SMLMFrameConnection" title="Permalink"></a></h1><p>Documentation for <a href="https://github.com/JuliaSMLM/SMLMFrameConnection.jl">SMLMFrameConnection</a>.</p><ul><li><a href="#SMLMFrameConnection.ParamStruct"><code>SMLMFrameConnection.ParamStruct</code></a></li><li><a href="#SMLMFrameConnection.combinelocalizations-Tuple{SMLMData.SMLD2D}"><code>SMLMFrameConnection.combinelocalizations</code></a></li><li><a href="#SMLMFrameConnection.compress_connectID-Tuple{Vector{Int64}}"><code>SMLMFrameConnection.compress_connectID</code></a></li><li><a href="#SMLMFrameConnection.compress_connectID!-Tuple{Vector{Int64}}"><code>SMLMFrameConnection.compress_connectID!</code></a></li><li><a href="#SMLMFrameConnection.computeclusterinfo-Tuple{Vector{Matrix{Float32}}}"><code>SMLMFrameConnection.computeclusterinfo</code></a></li><li><a href="#SMLMFrameConnection.connect1DS!-Tuple{SMLMData.SMLD2D, Int64}"><code>SMLMFrameConnection.connect1DS!</code></a></li><li><a href="#SMLMFrameConnection.connectlocalizations-Tuple{Vector{Int64}, Vector{Matrix{Float32}}, SMLMFrameConnection.ParamStruct, Int64}"><code>SMLMFrameConnection.connectlocalizations</code></a></li><li><a href="#SMLMFrameConnection.connectlocalizations!-Tuple{Vector{Int64}, Vector{Matrix{Float32}}, SMLMFrameConnection.ParamStruct, Int64}"><code>SMLMFrameConnection.connectlocalizations!</code></a></li><li><a href="#SMLMFrameConnection.create_costmatrix-Tuple{Vector{Matrix{Float32}}, SMLMFrameConnection.ParamStruct, Int64, Int64}"><code>SMLMFrameConnection.create_costmatrix</code></a></li><li><a href="#SMLMFrameConnection.defineidealFC!-Tuple{SMLMData.SMLD2D}"><code>SMLMFrameConnection.defineidealFC!</code></a></li><li><a href="#SMLMFrameConnection.estimatedensities-Tuple{SMLMData.SMLD2D, Vector{Matrix{Float32}}, SMLMFrameConnection.ParamStruct}"><code>SMLMFrameConnection.estimatedensities</code></a></li><li><a href="#SMLMFrameConnection.estimateparams-Tuple{SMLMData.SMLD2D, Vector{Matrix{Float32}}}"><code>SMLMFrameConnection.estimateparams</code></a></li><li><a href="#SMLMFrameConnection.frameconnect-Tuple{SMLMData.SMLD2D}"><code>SMLMFrameConnection.frameconnect</code></a></li><li><a href="#SMLMFrameConnection.frameconnect!-Tuple{SMLMData.SMLD2D}"><code>SMLMFrameConnection.frameconnect!</code></a></li><li><a href="#SMLMFrameConnection.linkclusters-Tuple{Vector{Int64}, Int64, Union{Int64, Vector{Int64}}, Vector{Int64}}"><code>SMLMFrameConnection.linkclusters</code></a></li><li><a href="#SMLMFrameConnection.linkclusters!-Tuple{Vector{Int64}, Int64, Union{Int64, Vector{Int64}}, Vector{Int64}}"><code>SMLMFrameConnection.linkclusters!</code></a></li><li><a href="#SMLMFrameConnection.organizeclusters-Tuple{SMLMData.SMLD2D}"><code>SMLMFrameConnection.organizeclusters</code></a></li><li><a href="#SMLMFrameConnection.precluster"><code>SMLMFrameConnection.precluster</code></a></li><li><a href="#SMLMFrameConnection.solveLAP-Tuple{Matrix{Float32}}"><code>SMLMFrameConnection.solveLAP</code></a></li></ul><article class="docstring"><header><a class="docstring-binding" id="SMLMFrameConnection.ParamStruct" href="#SMLMFrameConnection.ParamStruct"><code>SMLMFrameConnection.ParamStruct</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">ParamStruct(initialdensity::Vector{Float64}, 
    k_on::Float64, k_off::Float64, k_bleach::Float64, p_miss::Float64, 
    nsigmadev::Float64, maxframegap::Int, nnearestclusters::Int)</code></pre><p>Structure of parameters needed for frame-connection.</p><p><strong>Fields</strong></p><ul><li><code>initialdensity</code>: Density of emitters at the start of the experiment.                   (see estimatedensities()) (emitters/pixel^2)</li><li><code>nnearestclusters</code>: Number of nearest preclusters used for local density                      estimates. (default = 2)(see estimatedensities())</li><li><code>k_on</code>: Rate at which dark emitters convert to the visible state.          (see estimateparams())(1/frame)</li><li><code>k_off</code>: Rate at which visible emitters are converted to the reversible dark          state. (see estimateparams())(1/frame)</li><li><code>k_bleach</code>: Rate at which visible emitters are irreversibly photobleached.             (see estimateparams())(1/frame)</li><li><code>p_miss</code>: Probability of missing a localization of a visible emitter.</li><li><code>nsigmadev</code>: Multiplier of localization errors that defines a pre-clustering              distance threshold. (default = 5)(see precluster())(pixels)</li><li><code>maxframegap</code>: Maximum frame gap between temporally adjacent localizations in                a precluster. (default = 5)(see precluster())(frames)</li><li><code>nmaxnn</code>: Maximum number of nearest-neighbors inspected for precluster            membership.  Ideally, this would be set to inf, but that&#39;s not           feasible for most data. (default = 2)(see precluster())</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaSMLM/SMLMFrameConnection.jl/blob/0c3758ca953398c422c9b4c281a435978adf4efb/src/structdefinitions.jl#L3-L29">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="SMLMFrameConnection.combinelocalizations-Tuple{SMLMData.SMLD2D}" href="#SMLMFrameConnection.combinelocalizations-Tuple{SMLMData.SMLD2D}"><code>SMLMFrameConnection.combinelocalizations</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">smld_combined = combinelocalizations(smld::SMLMData.SMLD2D)</code></pre><p>Combine clustered localizations in <code>smld</code> into higher precision localizations.</p><p><strong>Description</strong></p><p>This function combines localizations in <code>smld</code> that share the same value of smld.connectID.  Localizations are combined assuming they arose from  independent measurements of the same position with Gaussian errors.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaSMLM/SMLMFrameConnection.jl/blob/0c3758ca953398c422c9b4c281a435978adf4efb/src/combinelocalizations.jl#L4-L13">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="SMLMFrameConnection.compress_connectID!-Tuple{Vector{Int64}}" href="#SMLMFrameConnection.compress_connectID!-Tuple{Vector{Int64}}"><code>SMLMFrameConnection.compress_connectID!</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">compress_connectID!(connectID::Vector{Int32})</code></pre><p>Make <code>connectID</code> consists of the set of integers <code>1:length(unique(connectID))</code>`</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaSMLM/SMLMFrameConnection.jl/blob/0c3758ca953398c422c9b4c281a435978adf4efb/src/compress_connectID.jl#L3-L7">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="SMLMFrameConnection.compress_connectID-Tuple{Vector{Int64}}" href="#SMLMFrameConnection.compress_connectID-Tuple{Vector{Int64}}"><code>SMLMFrameConnection.compress_connectID</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">connectID = compress_connectID(connectID::Vector{Int32})</code></pre><p>Make <code>connectID</code> consists of the set of integers <code>1:length(unique(connectID))</code>`</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaSMLM/SMLMFrameConnection.jl/blob/0c3758ca953398c422c9b4c281a435978adf4efb/src/compress_connectID.jl#L26-L30">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="SMLMFrameConnection.computeclusterinfo-Tuple{Vector{Matrix{Float32}}}" href="#SMLMFrameConnection.computeclusterinfo-Tuple{Vector{Matrix{Float32}}}"><code>SMLMFrameConnection.computeclusterinfo</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">clusterdurations, nobservations = 
    computeclusterinfo(clusterdata::Vector{Matrix{Float32}})</code></pre><p>Compute the durations of and number of member localizations in clusters.</p><p><strong>Description</strong></p><p>This method computes the duration of each cluster and the number of localizations in each cluster present in the input <code>clusterdata</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaSMLM/SMLMFrameConnection.jl/blob/0c3758ca953398c422c9b4c281a435978adf4efb/src/computeclusterinfo.jl#L1-L10">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="SMLMFrameConnection.connect1DS!-Tuple{SMLMData.SMLD2D, Int64}" href="#SMLMFrameConnection.connect1DS!-Tuple{SMLMData.SMLD2D, Int64}"><code>SMLMFrameConnection.connect1DS!</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">connect1DS!(smld::SMLMData.SMLD2D, dataset::Int; maxframegap::Int = 5)</code></pre><p>Define the &quot;ideal&quot; frame-connection result for simulated <code>smld</code> with one dataset.</p><p><strong>Description</strong></p><p>This is a helper function which defines the ideal FC result for a single  dataset.  The user should probably not bother using this, and instead should call defineidealFC().</p><p><strong>Inputs</strong></p><ul><li><code>smld</code>: SMLMData.SMLD2D with smld.connectID populated to indicate emitter ID.</li><li><code>dataset</code>: Dataset number to be connected.</li><li><code>maxframegap</code>: Maximum frame gap allowed between localizations connected in                the &quot;ideal&quot; result.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaSMLM/SMLMFrameConnection.jl/blob/0c3758ca953398c422c9b4c281a435978adf4efb/src/defineidealFC.jl#L4-L19">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="SMLMFrameConnection.connectlocalizations!-Tuple{Vector{Int64}, Vector{Matrix{Float32}}, SMLMFrameConnection.ParamStruct, Int64}" href="#SMLMFrameConnection.connectlocalizations!-Tuple{Vector{Int64}, Vector{Matrix{Float32}}, SMLMFrameConnection.ParamStruct, Int64}"><code>SMLMFrameConnection.connectlocalizations!</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">connectlocalizations!(connectID::Vector{Int64}, 
    clusterdata::Vector{Matrix{Float32}}, 
    params::ParamStruct, nframes::Int64)</code></pre><p>Connect localizations in <code>clusterdata</code> by solving a linear assignment problem.</p><p><strong>Description</strong></p><p>Connect localizations in <code>clusterdata</code> by giving &quot;connected&quot; localizations the same integer value for their field <code>smd.connectID</code>.  Associations are made by solving a linear assignment problem which designates the ideal connections between localizations.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaSMLM/SMLMFrameConnection.jl/blob/0c3758ca953398c422c9b4c281a435978adf4efb/src/connectlocalizations.jl#L3-L15">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="SMLMFrameConnection.connectlocalizations-Tuple{Vector{Int64}, Vector{Matrix{Float32}}, SMLMFrameConnection.ParamStruct, Int64}" href="#SMLMFrameConnection.connectlocalizations-Tuple{Vector{Int64}, Vector{Matrix{Float32}}, SMLMFrameConnection.ParamStruct, Int64}"><code>SMLMFrameConnection.connectlocalizations</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">connectID = connectlocalizations(connectID::Vector{Int64}, 
    clusterdata::Vector{Matrix{Float32}}, 
    params::ParamStruct, nframes::Int64)</code></pre><p>Connect localizations in <code>clusterdata</code> by solving a linear assignment problem.</p><p><strong>Description</strong></p><p>Connect localizations in <code>clusterdata</code> by giving &quot;connected&quot; localizations the same integer value for their field <code>smd.connectID</code>.  Associations are made by solving a linear assignment problem which designates the ideal connections between localizations.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaSMLM/SMLMFrameConnection.jl/blob/0c3758ca953398c422c9b4c281a435978adf4efb/src/connectlocalizations.jl#L40-L52">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="SMLMFrameConnection.create_costmatrix-Tuple{Vector{Matrix{Float32}}, SMLMFrameConnection.ParamStruct, Int64, Int64}" href="#SMLMFrameConnection.create_costmatrix-Tuple{Vector{Matrix{Float32}}, SMLMFrameConnection.ParamStruct, Int64, Int64}"><code>SMLMFrameConnection.create_costmatrix</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">costmatrix = create_costmatrix(clusterdata::Vector{Matrix{Float32}}, 
    params::ParamStruct, nframes::Int64)</code></pre><p>Create a cost matrix for connections between localizations in <code>clusterdata</code>.</p><p><strong>Description</strong></p><p>The costs associated with connecting/not connecting the localizations in the input set of data in <code>clusterdata</code> are placed in entries of the output matrix <code>costmatrix</code>.  For N localizations in <code>clusterdata</code>, the output <code>costmatrix</code> will be an 2Nx2N block matrix.  The NxN blocks are attributed the following meanings: the upper-left &quot;connection&quot; block corresponds to adding localizations to existing clusters of other localizations, the bottom-left &quot;birth&quot; block  corresponds to introduction of a new cluster, and the upper-right &quot;death&quot; block corresponds to preventing admission of any more localizations to a cluster. The bottom-right &quot;auxillary&quot; block is the transpose of the &quot;connection&quot; block. Forbidden connections are indicated by <code>missing</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaSMLM/SMLMFrameConnection.jl/blob/0c3758ca953398c422c9b4c281a435978adf4efb/src/create_costmatrix.jl#L1-L18">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="SMLMFrameConnection.defineidealFC!-Tuple{SMLMData.SMLD2D}" href="#SMLMFrameConnection.defineidealFC!-Tuple{SMLMData.SMLD2D}"><code>SMLMFrameConnection.defineidealFC!</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">smld, smld_combined = defineidealFC!(smld::SMLMData.SMLD2D; 
    maxframegap::Int = 5)</code></pre><p>Define the &quot;ideal&quot; frame-connection result for a simulated <code>smld</code>.</p><p><strong>Description</strong></p><p>This function defines the &quot;ideal&quot; frame connection result from a simulation. That is to say, for a simulated SMLD2D structure <code>smld</code> with <code>connectID</code> field populated to indicate emitter membership of localizations, this function will generate an &quot;ideal&quot; FC result which combines all blinking events that appeared with frame gaps less than <code>maxframegap</code> of one another.  Note that for very high duty cycles, multiple blinking events might be mistakingly combined by this method (i.e., if the emitter blinks back on within <code>maxframegap</code> frames of its previous blink).  Note that localizations are not allowed to be  connected across datasets.</p><p><strong>Inputs</strong></p><p>-<code>smld</code>: SMLMData.SMLD2D with smld.connectID populated to indicate emitter ID. -<code>maxframegap</code>: Maximum frame gap allowed between localizations connected in                 the &quot;ideal&quot; result.</p><p><strong>Outputs</strong></p><p>-<code>smld_out</code>: Ideal frame-connection result on input <code>smld</code> with localizations              combined as appropriate. -<code>smld_connected</code>: Copy of the input <code>smld</code> with smld<em>connected.connectID                     modified to reflect blinking event ID (i.e., `smld</em>out` is                    generated as smld<em>out = combinelocalizations(smld</em>connected))</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaSMLM/SMLMFrameConnection.jl/blob/0c3758ca953398c422c9b4c281a435978adf4efb/src/defineidealFC.jl#L67-L95">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="SMLMFrameConnection.estimatedensities-Tuple{SMLMData.SMLD2D, Vector{Matrix{Float32}}, SMLMFrameConnection.ParamStruct}" href="#SMLMFrameConnection.estimatedensities-Tuple{SMLMData.SMLD2D, Vector{Matrix{Float32}}, SMLMFrameConnection.ParamStruct}"><code>SMLMFrameConnection.estimatedensities</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">initialdensity = estimatedensities(smld::SMLMData.SMLD2D, 
    clusterdata::Vector{Matrix{Float32}}, params::ParamStruct)</code></pre><p>Estimate local emitter densities for clusters in <code>smld</code> and <code>clusterdata</code>.</p><p><strong>Description</strong></p><p>The initial local densities <code>initialdensity</code> around each pre-cluster present in <code>smld</code>/<code>clusterdata</code> are estimated based on the local density of pre-clusters throughout the entire set of data as well as some of the rate parameters  provided in <code>params</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaSMLM/SMLMFrameConnection.jl/blob/0c3758ca953398c422c9b4c281a435978adf4efb/src/estimatedensities.jl#L4-L15">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="SMLMFrameConnection.estimateparams-Tuple{SMLMData.SMLD2D, Vector{Matrix{Float32}}}" href="#SMLMFrameConnection.estimateparams-Tuple{SMLMData.SMLD2D, Vector{Matrix{Float32}}}"><code>SMLMFrameConnection.estimateparams</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">k_on, k_off, k_bleach, p_miss, nemitters = 
    estimateparams(smld::SMLMData.SMLD2D, clusterdata::Vector{Matrix{Float32}})</code></pre><p>Estimate rate parameters from the clusters in <code>smld</code> and <code>clusterdata</code>.</p><p><strong>Description</strong></p><p>The rate parameters <code>k_on</code>, <code>k_off</code>, and <code>k_bleach</code>, the probability of missing a localization for a visible emitter <code>p_miss</code>, and the underlying number of emitters <code>nemitters</code> are estimated from the pre-clusters in  <code>smld</code>/<code>clusterdata</code>.  This is done by assuming that pre-clusters are, on  average, representative of a single blinking event of a single emitter.</p><p><strong>Citation</strong></p><p>Schodt David J., Lidke Keith A., &quot;Spatiotemporal Clustering of Repeated  Super-Resolution Localizations via Linear Assignment Problem&quot;,  Front. Bioinform., 20 October 2021 https://doi.org/10.3389/fbinf.2021.724325</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaSMLM/SMLMFrameConnection.jl/blob/0c3758ca953398c422c9b4c281a435978adf4efb/src/estimateparams.jl#L5-L23">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="SMLMFrameConnection.frameconnect!-Tuple{SMLMData.SMLD2D}" href="#SMLMFrameConnection.frameconnect!-Tuple{SMLMData.SMLD2D}"><code>SMLMFrameConnection.frameconnect!</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">smld, smld_preclustered, smld_combined, params = frameconnect!(smld::SMLMData.SMLD2D; 
    nnearestclusters::Int=2, nsigmadev::Float64=5.0, maxframegap::Int=5, nmaxnn::Int=2)</code></pre><p>Connect repeated localizations of the same emitter in <code>smld</code>.</p><p><strong>Description</strong></p><p>Repeated localizations of the same emitter present in <code>smld</code> are connected and combined into higher precision localizations of that emitter.  This is done by</p><ol><li>forming pre-clusters of localizations, 2) estimating rate parameters from</li></ol><p>the pre-clusters, 3) solving a linear assignment problem for connecting  localizations in each pre-cluster, and 4) combining the connected localizations using their MLE position estimate assuming Gaussian noise.</p><p><strong>Inputs</strong></p><ul><li><code>smld</code>: SMLD2D structure containing the localizations that should be          connected (see SMLMData.SMLD2D for organization/fields).</li><li><code>nnearestclusters</code>: Number of nearest preclusters used for local density                      estimates. (default = 2)(see estimatedensities())</li><li><code>nsigmadev</code>: Multiplier of localization errors that defines a pre-clustering              distance threshold. (default = 5)(see precluster())(pixels)</li><li><code>maxframegap</code>: Maximum frame gap between temporally adjacent localizations in                a precluster. (default = 5)(see precluster())(frames)</li><li><code>nmaxnn</code>: Maximum number of nearest-neighbors inspected for precluster            membership.  Ideally, this would be set to inf, but that&#39;s not           feasible for most data. (default = 2)(see precluster())</li></ul><p><strong>Outputs</strong></p><ul><li><code>smld</code>: Input <code>smld</code> with field connectID updated to reflect connected         localizations (however localizations remain uncombined).</li><li><code>smld_preclustered</code>: Copy of the input <code>smld</code> with the field connectID                      populated to reflect the results of pre-clustering.</li><li><code>smld_combined</code>: Final frame-connection result (i.e., <code>smld</code> with                   localizations that seem to be from the same blinking event                  combined into higher precision localizations).</li><li><code>params</code>: Structure of parameters used in the algorithm, with some copied            directly from the option kwargs to this function, and others            calculated internally (see SMLMFrameConnection.ParamStruct).</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaSMLM/SMLMFrameConnection.jl/blob/0c3758ca953398c422c9b4c281a435978adf4efb/src/frameconnect.jl#L3-L41">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="SMLMFrameConnection.frameconnect-Tuple{SMLMData.SMLD2D}" href="#SMLMFrameConnection.frameconnect-Tuple{SMLMData.SMLD2D}"><code>SMLMFrameConnection.frameconnect</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">smld, smld_preclustered, smld_combined, params = frameconnect(smld::SMLMData.SMLD2D; 
    nnearestclusters::Int=2, nsigmadev::Float64=5.0, maxframegap::Int=5, nmaxnn::Int=2)</code></pre><p>Connect repeated localizations of the same emitter in <code>smld</code>.</p><p><strong>Description</strong></p><p>Repeated localizations of the same emitter present in <code>smld</code> are connected and combined into higher precision localizations of that emitter.  This is done by</p><ol><li>forming pre-clusters of localizations, 2) estimating rate parameters from</li></ol><p>the pre-clusters, 3) solving a linear assignment problem for connecting  localizations in each pre-cluster, and 4) combining the connected localizations using their MLE position estimate assuming Gaussian noise.</p><p><strong>Inputs</strong></p><p>-<code>smld</code>: SMLD2D structure containing the localizations that should be           connected (see SMLMData.SMLD2D for organization/fields). -<code>nnearestclusters</code>: Number of nearest preclusters used for local density                       estimates. (default = 2)(see estimatedensities()) -<code>nsigmadev</code>: Multiplier of localization errors that defines a pre-clustering               distance threshold. (default = 5)(see precluster())(pixels) -<code>maxframegap</code>: Maximum frame gap between temporally adjacent localizations in                 a precluster. (default = 5)(see precluster())(frames) -<code>nmaxnn</code>: Maximum number of nearest-neighbors inspected for precluster             membership.  Ideally, this would be set to inf, but that&#39;s not            feasible for most data. (default = 2)(see precluster())</p><p><strong>Outputs</strong></p><p>-<code>smld</code>: Input <code>smld</code> with field connectID updated to reflect connected          localizations (however localizations remain uncombined). -<code>smld_preclustered</code>: Copy of the input <code>smld</code> with the field connectID                       populated to reflect the results of pre-clustering. -<code>smld_combined</code>: Final frame-connection result (i.e., <code>smld</code> with                    localizations that seem to be from the same blinking event                   combined into higher precision localizations). -<code>params</code>: Structure of parameters used in the algorithm, with some copied             directly from the option kwargs to this function, and others             calculated internally (see SMLMFrameConnection.ParamStruct).</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaSMLM/SMLMFrameConnection.jl/blob/0c3758ca953398c422c9b4c281a435978adf4efb/src/frameconnect.jl#L76-L114">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="SMLMFrameConnection.linkclusters!-Tuple{Vector{Int64}, Int64, Union{Int64, Vector{Int64}}, Vector{Int64}}" href="#SMLMFrameConnection.linkclusters!-Tuple{Vector{Int64}, Int64, Union{Int64, Vector{Int64}}, Vector{Int64}}"><code>SMLMFrameConnection.linkclusters!</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">connectID, maxconnectID = linkclusters!(connectID::Int64, 
    maxconnectID::Int64, updateind::Vector{Int64}, 
    assignment::Vector{Int64})</code></pre><p>Force localizations linked by <code>assignment</code> to share same the same <code>connectID</code></p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaSMLM/SMLMFrameConnection.jl/blob/0c3758ca953398c422c9b4c281a435978adf4efb/src/linkclusters.jl#L1-L7">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="SMLMFrameConnection.linkclusters-Tuple{Vector{Int64}, Int64, Union{Int64, Vector{Int64}}, Vector{Int64}}" href="#SMLMFrameConnection.linkclusters-Tuple{Vector{Int64}, Int64, Union{Int64, Vector{Int64}}, Vector{Int64}}"><code>SMLMFrameConnection.linkclusters</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">connectID, maxconnectID = linkclusters(
    connectID::Int64, maxconnectID::Int64, 
    updateind::Vector{Int64}, assignment::Vector{Int64})</code></pre><p>Force localizations linked by <code>assignment</code> to share same the same <code>connectID</code></p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaSMLM/SMLMFrameConnection.jl/blob/0c3758ca953398c422c9b4c281a435978adf4efb/src/linkclusters.jl#L45-L51">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="SMLMFrameConnection.organizeclusters-Tuple{SMLMData.SMLD2D}" href="#SMLMFrameConnection.organizeclusters-Tuple{SMLMData.SMLD2D}"><code>SMLMFrameConnection.organizeclusters</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">clusterdata = organizeclusters(smld::SMLMData.SMLD2D)</code></pre><p>Organize pre-clusters into a vector indexing distinct clusters.</p><p><strong>Description</strong></p><p>Pre-clusters in the input <code>smld</code>, as related by their shared integer value k_off <code>smld.connectID</code>, are organized into a vector of matrices <code>clusterdata</code>.  Each index of <code>clusterdata</code> corresponds to a distinct cluster.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaSMLM/SMLMFrameConnection.jl/blob/0c3758ca953398c422c9b4c281a435978adf4efb/src/organizeclusters.jl#L3-L12">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="SMLMFrameConnection.precluster" href="#SMLMFrameConnection.precluster"><code>SMLMFrameConnection.precluster</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">smld_preclustered = precluster(smld::SMLMData.SMLD2D, 
    params::ParamStruct = ParamStruct())</code></pre><p>Cluster localizations in <code>smld</code> based on distance and time thresholds in <code>params</code>.</p><p><strong>Description</strong></p><p>Localizations in the input structure <code>smd</code> are clustered together based on their spatiotemporal separations.  All localizations within a spatial  threshold of <code>params.nsigmadev*mean([smld.σ_x smld.σ_y)</code> and a temporal  threshold of <code>params.maxframegap</code> of one another will be clustered together, meaning that these localizations now share the same unique integer value for smld.connectID.</p><p><strong>Notes</strong></p><p>Pre-clustering allows localizations observed in the same frame to be in the same cluster.  This is done to prevent exclusion of the &quot;correct&quot; localization from its ideal cluster due to a previously included &quot;incorrect&quot; localization into that cluster.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaSMLM/SMLMFrameConnection.jl/blob/0c3758ca953398c422c9b4c281a435978adf4efb/src/precluster.jl#L5-L24">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="SMLMFrameConnection.solveLAP-Tuple{Matrix{Float32}}" href="#SMLMFrameConnection.solveLAP-Tuple{Matrix{Float32}}"><code>SMLMFrameConnection.solveLAP</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">assignment, cost = solveLAP(costmatrix::Matrix{Float32})</code></pre><p>Solve the linear assignment problem designated by <code>costmatrix</code>.</p><p><strong>Description</strong></p><p>Solve the linear assignment problem (LAP) defined by <code>costmatrix</code> using the package Hungarian.jl.  For now, this method is just a wrapper around  Hungarian.jl, however the intention is to add more checks and options to this method in the future.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaSMLM/SMLMFrameConnection.jl/blob/0c3758ca953398c422c9b4c281a435978adf4efb/src/solveLAP.jl#L3-L13">source</a></section></article></article><nav class="docs-footer"><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 0.27.10 on <span class="colophon-date" title="Wednesday 16 February 2022 21:38">Wednesday 16 February 2022</span>. Using Julia version 1.7.2.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
